<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta charset="utf-8" />
<meta name="generator" content="Docutils 0.21.2: https://docutils.sourceforge.io/" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Database Test 5 (DBT-5) Documentation</title>
<style type="text/css">

/* Minimal style sheet for the HTML output of Docutils.                    */
/*                                                                         */
/* :Author: Günter Milde, based on html4css1.css by David Goodger          */
/* :Id: $Id: minimal.css 9545 2024-02-17 10:37:56Z milde $                                                               */
/* :Copyright: © 2015, 2021 Günter Milde.                                  */
/* :License: Released under the terms of the `2-Clause BSD license`_,      */
/*    in short:                                                            */
/*                                                                         */
/*    Copying and distribution of this file, with or without modification, */
/*    are permitted in any medium without royalty provided the copyright   */
/*    notice and this notice are preserved.                                */
/*                                                                         */
/*    This file is offered as-is, without any warranty.                    */
/*                                                                         */
/* .. _2-Clause BSD license: http://www.spdx.org/licenses/BSD-2-Clause     */

/* This CSS3 stylesheet defines rules for Docutils elements without        */
/* HTML equivalent. It is required to make the document semantics visible. */
/*                                                                         */
/* .. _validates: http://jigsaw.w3.org/css-validator/validator$link        */

/* titles */
p.topic-title,
p.admonition-title,
p.system-message-title {
  font-weight: bold;
}
p.sidebar-title,
p.rubric {
  font-weight: bold;
  font-size: larger;
}
p.rubric {
  color: maroon;
}
p.subtitle,
p.section-subtitle,
p.sidebar-subtitle {
  font-weight: bold;
  margin-top: -0.5em;
}
h1 + p.subtitle {
  font-size: 1.6em;
}
a.toc-backref {
  color: inherit;
  text-decoration: none;
}

/* Warnings, Errors */
.system-messages h2,
.system-message-title,
pre.problematic,
span.problematic {
  color: red;
}

/* Inline Literals */
.docutils.literal {
  font-family: monospace;
  white-space: pre-wrap;
}
/* do not wrap at hyphens and similar: */
.literal > span.pre { white-space: nowrap; }

/* keep line-breaks (\n) visible */
.pre-wrap { white-space: pre-wrap; }

/* Lists */

/* compact and simple lists: no margin between items */
.simple  li, .simple  ul, .simple  ol,
.compact li, .compact ul, .compact ol,
.simple  > li p, dl.simple  > dd,
.compact > li p, dl.compact > dd {
  margin-top: 0;
  margin-bottom: 0;
}
/* Nested Paragraphs */
p:first-child { margin-top: 0; }
p:last-child { margin-bottom: 0; }
details > p:last-child { margin-bottom: 1em; }

/* Table of Contents */
.contents ul.auto-toc { /* section numbers present */
  list-style-type: none;
}

/* Enumerated Lists */
ol.arabic     { list-style: decimal }
ol.loweralpha { list-style: lower-alpha }
ol.upperalpha { list-style: upper-alpha }
ol.lowerroman { list-style: lower-roman }
ol.upperroman { list-style: upper-roman }

/* Definition Lists and Derivatives */
dt .classifier { font-style: italic }
dt .classifier:before {
  font-style: normal;
  margin: 0.5em;
  content: ":";
}
/* Field Lists and similar */
/* bold field name, content starts on the same line */
dl.field-list,
dl.option-list,
dl.docinfo {
  display: flow-root;
}
dl.field-list > dt,
dl.option-list > dt,
dl.docinfo > dt {
  font-weight: bold;
  clear: left;
  float: left;
  margin: 0;
  padding: 0;
  padding-right: 0.25em;
}
/* Offset for field content (corresponds to the --field-name-limit option) */
dl.field-list > dd,
dl.option-list > dd,
dl.docinfo > dd {
  margin-left:  9em; /* ca. 14 chars in the test examples, fit all Docinfo fields */
}
/* start nested lists on new line */
dd > dl:first-child,
dd > ul:first-child,
dd > ol:first-child {
  clear: left;
}
/* start field-body on a new line after long field names */
dl.field-list > dd > *:first-child,
dl.option-list > dd > *:first-child
{
  display: inline-block;
  width: 100%;
  margin: 0;
}

/* Bibliographic Fields (docinfo) */
dl.docinfo pre.address {
  font: inherit;
  margin: 0.5em 0;
}
dl.docinfo > dd.authors > p { margin: 0; }

/* Option Lists */
dl.option-list > dt { font-weight: normal; }
span.option { white-space: nowrap; }

/* Footnotes and Citations  */

.footnote, .citation { margin: 1em 0; } /* default paragraph skip (Firefox) */
/* hanging indent */
.citation { padding-left: 2em; }
.footnote { padding-left: 1.7em; }
.footnote.superscript { padding-left: 1.0em; }
.citation > .label { margin-left: -2em; }
.footnote > .label { margin-left: -1.7em; }
.footnote.superscript > .label { margin-left: -1.0em; }

.footnote > .label + *,
.citation > .label + * {
  display: inline-block;
  margin-top: 0;
  vertical-align: top;
}
.footnote > .backrefs + *,
.citation > .backrefs + * {
  margin-top: 0;
}
.footnote > .label + p, .footnote > .backrefs + p,
.citation > .label + p, .citation > .backrefs + p {
  display: inline;
  vertical-align: inherit;
}

.backrefs { user-select: none; }
.backrefs > a { font-style: italic; }

/* superscript footnotes */
a[role="doc-noteref"].superscript,
.footnote.superscript > .label,
.footnote.superscript > .backrefs {
  vertical-align: super;
  font-size: smaller;
  line-height: 1;
}
a[role="doc-noteref"].superscript > .fn-bracket,
.footnote.superscript > .label > .fn-bracket {
  /* hide brackets in display but leave for copy/paste */
  display: inline-block;
  width: 0;
  overflow: hidden;
}
[role="doc-noteref"].superscript + [role="doc-noteref"].superscript {
  padding-left: 0.15em; /* separate consecutive footnote references */
  /* TODO: unfortunately, "+" also selects with text between the references. */
}

/* Alignment */
.align-left   {
  text-align: left;
  margin-right: auto;
}
.align-center {
  text-align: center;
  margin-left: auto;
  margin-right: auto;
}
.align-right  {
  text-align: right;
  margin-left: auto;
}
.align-top    { vertical-align: top; }
.align-middle { vertical-align: middle; }
.align-bottom { vertical-align: bottom; }

/* reset inner alignment in figures and tables */
figure.align-left, figure.align-right,
table.align-left, table.align-center, table.align-right {
  text-align: inherit;
}

/* Text Blocks */
.topic { margin: 1em 2em; }
.sidebar,
.admonition,
.system-message {
  margin: 1em 2em;
  border: thin solid;
  padding: 0.5em 1em;
}
div.line-block { display: block; }
div.line-block div.line-block, pre { margin-left: 2em; }

/* Code line numbers: dropped when copying text from the page */
pre.code .ln { display: none; }
pre.code code:before {
  content: attr(data-lineno); /* …, none) fallback not supported by any browser */
  color: gray;
}

/* Tables */
table {
  border-collapse: collapse;
}
td, th {
  border: thin solid silver;
  padding: 0 1ex;
}
.borderless td, .borderless th {
  border: 0;
  padding: 0;
  padding-right: 0.5em /* separate table cells */
}

table > caption, figcaption {
  text-align: left;
  margin-top: 0.2em;
  margin-bottom: 0.2em;
}
table.captionbelow {
  caption-side: bottom;
}

/* MathML (see "math.css" for --math-output=HTML) */
math .boldsymbol { font-weight: bold; }
math.boxed, math .boxed {padding: 0.25em; border: thin solid; }
/* style table similar to AMS "align" or "aligned" environment: */
mtable.cases > mtr > mtd { text-align: left; }
mtable.ams-align > mtr > mtd { padding-left: 0; padding-right: 0; }
mtable.ams-align > mtr > mtd:nth-child(2n) { text-align: left; }
mtable.ams-align > mtr > mtd:nth-child(2n+1) { text-align: right; }
mtable.ams-align > mtr > mtd:nth-child(2n+3) { padding-left: 2em; }
.mathscr mi, mi.mathscr {
  font-family: STIX, XITSMathJax_Script, rsfs10,
               "Asana Math", Garamond, cursive;
}

/* Document Header and Footer */
header { border-bottom: 1px solid black; }
footer { border-top: 1px solid black; }

/* Images are block-level by default in Docutils */
/* New HTML5 block elements: set display for older browsers */
img, svg, header, footer, main, aside, nav, section, figure, video, details {
  display: block;
}
svg { width: auto; height: auto; }  /* enable scaling of SVG images */
/* inline images */
p img, p svg, p video { display: inline; }

</style>
<style type="text/css">

/* CSS31_ style sheet for the output of Docutils HTML writers.             */
/* Rules for easy reading and pre-defined style variants.                  */
/*                                                                         */
/* :Author: Günter Milde, based on html4css1.css by David Goodger          */
/* :Id: $Id: plain.css 9615 2024-04-06 13:28:15Z milde $                                                               */
/* :Copyright: © 2015 Günter Milde.                                        */
/* :License: Released under the terms of the `2-Clause BSD license`_,      */
/*    in short:                                                            */
/*                                                                         */
/*    Copying and distribution of this file, with or without modification, */
/*    are permitted in any medium without royalty provided the copyright   */
/*    notice and this notice are preserved.                                */
/*                                                                         */
/*    This file is offered as-is, without any warranty.                    */
/*                                                                         */
/* .. _2-Clause BSD license: http://www.spdx.org/licenses/BSD-2-Clause     */
/* .. _CSS3: https://www.w3.org/Style/CSS/                                 */


/* Document Structure */
/* ****************** */

/* "page layout" */
body {
  margin: 0;
  background-color: #dbdbdb;
  --field-indent: 9em; /* default indent of fields in field lists */
}
main, footer, header {
  line-height:1.6;
  /* avoid long lines --> better reading */
  /* optimum is 45…75 characters/line <http://webtypography.net/2.1.2> */
  /* OTOH: lines should not be too short because of missing hyphenation, */
  max-width: 50rem;
  padding: 1px 2%; /* 1px on top avoids grey bar above title (mozilla) */
  margin: auto;
}
main {
  counter-reset: table figure;
  background-color: white;
}
footer, header {
  font-size: smaller;
  padding: 0.5em 2%;
  border: none;
}

/* Table of Contents */
ul.auto-toc > li > p {
  padding-left: 1em;
  text-indent: -1em;
}
nav.contents ul {
  padding-left: 1em;
}
main > nav.contents ul ul ul ul:not(.auto-toc) {
  list-style-type: '\2B29\ ';
}
main > nav.contents ul ul ul ul ul:not(.auto-toc) {
  list-style-type: '\2B1D\ ';
}

/* Transitions */
hr.docutils {
  width: 80%;
  margin-top: 1em;
  margin-bottom: 1em;
  clear: both;
}

/* Paragraphs */

/* vertical space (parskip) */
p, ol, ul, dl, li,
.footnote, .citation,
div > math,
table {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

h1, h2, h3, h4, h5, h6,
dd, details > p:last-child {
  margin-bottom: 0.5em;
}

/* Lists */
/* ===== */

/* Definition Lists */
/* Indent lists nested in definition lists */
dd > ul:only-child, dd > ol:only-child { padding-left: 1em; }

/* Description Lists */
/* styled like in most dictionaries, encyclopedias etc. */
dl.description {
  display: flow-root;
}
dl.description > dt {
  font-weight: bold;
  clear: left;
  float: left;
  margin: 0;
  padding: 0;
  padding-right: 0.3em;
}
dl.description > dd:after {
  display: table;
  content: "";
  clear: left; /* clearfix for empty descriptions */
}

/* Field Lists */

dl.field-list > dd,
dl.docinfo > dd {
  margin-left: var(--field-indent); /* adapted in media queries or HTML */
}

/* example for custom field-name width */
dl.field-list.narrow > dd {
  --field-indent: 5em;
}
/* run-in: start field-body on same line after long field names */
dl.field-list.run-in > dd p {
  display: block;
}

/* Bibliographic Fields */

/* generally, bibliographic fields use dl.docinfo */
/* but dedication and abstract are placed into divs */
div.abstract p.topic-title {
  text-align: center;
}
div.dedication {
  margin: 2em 5em;
  text-align: center;
  font-style: italic;
}
div.dedication p.topic-title {
  font-style: normal;
}

/* disclosures */
details { padding-left: 1em; }
summary { margin-left: -1em; }

/* Text Blocks */
/* =========== */

/* Literal Blocks */
pre.literal-block, pre.doctest-block,
pre.math, pre.code {
  font-family: monospace;
}

/* Block Quotes and Topics */
bockquote { margin: 1em 2em; }
blockquote p.attribution,
.topic p.attribution {
  text-align: right;
  margin-left: 20%;
}

/* Tables */
/* ====== */

/* th { vertical-align: bottom; } */

table tr { text-align: left; }

/* "booktabs" style (no vertical lines) */
table.booktabs {
  border: 0;
  border-top: 2px solid;
  border-bottom: 2px solid;
  border-collapse: collapse;
}
table.booktabs * {
  border: 0;
}
table.booktabs th {
  border-bottom: thin solid;
}

/* numbered tables (counter defined in div.document) */
table.numbered > caption:before {
  counter-increment: table;
  content: "Table " counter(table) ": ";
  font-weight: bold;
}

/* Explicit Markup Blocks */
/* ====================== */

/* Footnotes and Citations */
/* ----------------------- */

/* line on the left */
.footnote-list {
  border-left: solid thin;
  padding-left: 0.25em;
}

/* Directives */
/* ---------- */

/* Body Elements */
/* ~~~~~~~~~~~~~ */

/* Images and Figures */

/* let content flow to the side of aligned images and figures */
figure.align-left,
img.align-left,
svg.align-left,
video.align-left,
div.align-left,
object.align-left {
  clear: left;
  float: left;
  margin-right: 1em;
}
figure.align-right,
img.align-right,
svg.align-right,
video.align-right,
div.align-right,
object.align-right {
  clear: right;
  float: right;
  margin-left: 1em;
}
/* Stop floating sidebars, images and figures */
h1, h2, h3, h4, footer, header { clear: both; }

/* Numbered figures */
figure.numbered > figcaption > p:before {
  counter-increment: figure;
  content: "Figure " counter(figure) ": ";
  font-weight: bold;
}

/* Admonitions and System Messages */
.caution p.admonition-title,
.attention p.admonition-title,
.danger p.admonition-title,
.error p.admonition-title,
.warning p.admonition-title,
div.error {
  color: red;
}

/* Sidebar */
/* Move right. In a layout with fixed margins, */
/* it can be moved into the margin.            */
aside.sidebar {
  width: 30%;
  max-width: 26em;
  float: right;
  clear: right;
  margin-left: 1em;
  margin-right: -1%;
  background-color: #fffffa;
}


/* Code */
pre.code { padding: 0.7ex }
pre.code, code { background-color: #eeeeee }
/* basic highlighting: for a complete scheme, see */
/* https://docutils.sourceforge.io/sandbox/stylesheets/ */
pre.code .comment, code .comment { color: #5C6576 }
pre.code .keyword, code .keyword { color: #3B0D06; font-weight: bold }
pre.code .literal.string, code .literal.string { color: #0C5404 }
pre.code .name.builtin, code .name.builtin { color: #352B84 }
pre.code .deleted, code .deleted { background-color: #DEB0A1}
pre.code .inserted, code .inserted { background-color: #A3D289}


/* Epigraph           */
/* Highlights         */
/* Pull-Quote         */
/* Compound Paragraph */
/* Container          */

/* Inline Markup */
/* ============= */

sup, sub { line-height: 0.8; } /* do not add leading for lines with sup/sub */

/* Inline Literals                                          */
/* possible values: normal, nowrap, pre, pre-wrap, pre-line */
/*   span.docutils.literal { white-space: pre-wrap; }       */

/* Hyperlink References */
a { text-decoration: none; }

/* External Targets       */
/*   span.target.external */
/* Internal Targets       */
/*   span.target.internal */
/* Footnote References    */
/*   a[role="doc-noteref"] */
/* Citation References    */
/*   a.citation-reference */

</style>
</head>
<body class="with-toc">
<main id="database-test-5-dbt-5-documentation">
<h1 class="title">Database Test 5 (DBT-5) Documentation</h1>

<nav class="contents" id="table-of-contents" role="doc-toc">
<p class="topic-title"><a class="reference internal" href="#top">Table of Contents</a></p>
<ul class="simple">
<li><p><a class="reference internal" href="#introduction" id="toc-entry-1">Introduction</a></p></li>
<li><p><a class="reference internal" href="#design" id="toc-entry-2">Design</a></p>
<ul>
<li><p><a class="reference internal" href="#brokeragehouse" id="toc-entry-3">BrokerageHouse</a></p></li>
<li><p><a class="reference internal" href="#marketexchange" id="toc-entry-4">MarketExchange</a></p></li>
<li><p><a class="reference internal" href="#driver" id="toc-entry-5">Driver</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#installing-dbt-5" id="toc-entry-6">Installing DBT-5</a></p>
<ul>
<li><p><a class="reference internal" href="#required-software" id="toc-entry-7">Required Software</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#user-s-guide" id="toc-entry-8">User's Guide</a></p>
<ul>
<li><p><a class="reference internal" href="#building-tpc-e-tools" id="toc-entry-9">Building TPC-E Tools</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#database-management-system-notes" id="toc-entry-10">Database Management System Notes</a></p>
<ul>
<li><p><a class="reference internal" href="#postgresql" id="toc-entry-11">PostgreSQL</a></p>
<ul>
<li><p><a class="reference internal" href="#building-the-kit" id="toc-entry-12">Building the Kit</a></p></li>
<li><p><a class="reference internal" href="#configuration" id="toc-entry-13">Configuration</a></p></li>
<li><p><a class="reference internal" href="#build-the-database" id="toc-entry-14">Build the Database</a></p></li>
<li><p><a class="reference internal" href="#run-a-test" id="toc-entry-15">Run a Test</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#performance-testing" id="toc-entry-16">Performance Testing</a></p>
<ul>
<li><p><a class="reference internal" href="#database-connection-scaling" id="toc-entry-17">Database Connection Scaling</a></p></li>
<li><p><a class="reference internal" href="#database-parameter-effects" id="toc-entry-18">Database Parameter Effects</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#developer-guide" id="toc-entry-19">Developer Guide</a></p>
<ul>
<li><p><a class="reference internal" href="#building-the-kit-1" id="toc-entry-20">Building the Kit</a></p></li>
<li><p><a class="reference internal" href="#appimage" id="toc-entry-21">AppImage</a></p>
<ul>
<li><p><a class="reference internal" href="#building-the-appimage" id="toc-entry-22">Building the AppImage</a></p></li>
<li><p><a class="reference internal" href="#including-tpc-e-tools-in-the-appimage" id="toc-entry-23">Including TPC-E Tools in the AppImage</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
<section id="introduction">
<h2><a class="toc-backref" href="#toc-entry-1" role="doc-backlink">Introduction</a></h2>
<p>This document provides instructions on how to set up and use the Open Source
Development Lab's Database Test 5 (DBT-5) kit.  This kit is an open source
fair-use implementation of the TPC Benchmark(TM) E (TPC-E) specification, which
is an on-line transaction processing benchmark.</p>
<p>An introduction and complete details on the TPC-E can be found at:
<a class="reference external" href="https://tpc.org/tpce/">https://tpc.org/tpce/</a></p>
</section>
<section id="design">
<h2><a class="toc-backref" href="#toc-entry-2" role="doc-backlink">Design</a></h2>
<p>DBT-5 implements the workload with three binaries: <strong>BrokerageHouse</strong>,
<strong>MarketExchange</strong>, and <strong>Driver</strong>.</p>
<section id="brokeragehouse">
<h3><a class="toc-backref" href="#toc-entry-3" role="doc-backlink">BrokerageHouse</a></h3>
<p><strong>BrokerageHouse</strong> is responsible for executing all of the database
transactions.  It implements the <strong>EGenTxnHarness</strong> and <strong>EGenDriverDM</strong>.</p>
</section>
<section id="marketexchange">
<h3><a class="toc-backref" href="#toc-entry-4" role="doc-backlink">MarketExchange</a></h3>
<p><strong>MarketExchange</strong> emulates stock exchanges and sends messages to the
<strong>BrokerageHouse</strong> for initial Trade Request and Mark Feed transactions.  It
implements the <strong>EGenDriverMEE</strong>.</p>
</section>
<section id="driver">
<h3><a class="toc-backref" href="#toc-entry-5" role="doc-backlink">Driver</a></h3>
<p><strong>Driver</strong> emulates customers and drives the workload.  It implements
<strong>EGenDriverCE</strong>.</p>
</section>
</section>
<section id="installing-dbt-5">
<h2><a class="toc-backref" href="#toc-entry-6" role="doc-backlink">Installing DBT-5</a></h2>
<p>The latest stable and development version of the kit can be found on GitHub:
<a class="reference external" href="https://github.com/osdldbt/dbt5">https://github.com/osdldbt/dbt5</a></p>
<p>The TPC's TPC-E Tools cannot be redistributed with DBT-5 and must be downloaded
separately from:
<a class="reference external" href="https://www.tpc.org/tpc_documents_current_versions/current_specifications5.asp">https://www.tpc.org/tpc_documents_current_versions/current_specifications5.asp</a></p>
<section id="required-software">
<h3><a class="toc-backref" href="#toc-entry-7" role="doc-backlink">Required Software</a></h3>
<p>In addition to the database management system software, the following is also
required:</p>
<ul class="simple">
<li><p>C++ compiler</p></li>
<li><p>patch</p></li>
<li><dl class="simple">
<dt>Database development libraries and header files</dt>
<dd><ul>
<li><dl class="simple">
<dt>PostgreSQL <a class="reference external" href="https://www.postgresql.org">https://www.postgresql.org</a></dt>
<dd><ul>
<li><p>psql</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
<li><p>SQLite <a class="reference external" href="https://www.sqlite.org/index.html">https://www.sqlite.org/index.html</a> is required for processing test
results</p></li>
</ul>
<p>Optional software:</p>
<ul class="simple">
<li><p><strong>sar</strong>, <strong>pidstat</strong> <a class="reference external" href="http://pagesperso-orange.fr/sebastien.godard/">http://pagesperso-orange.fr/sebastien.godard/</a> (While the
scripts assume this particular version of <strong>sar</strong> and <strong>pidstat</strong>, it is
possible to run on non-Linux based operating systems with some modifications
to the kit.)</p></li>
<li><p><strong>jq</strong> <a class="reference external" href="https://jqlang.github.io/jq/">https://jqlang.github.io/jq/</a> and <strong>toml-cli</strong>
<a class="reference external" href="https://github.com/gnprice/toml-cli">https://github.com/gnprice/toml-cli</a> are required to use TOML configuration
files for executing tests.</p></li>
</ul>
</section>
</section>
<section id="user-s-guide">
<h2><a class="toc-backref" href="#toc-entry-8" role="doc-backlink">User's Guide</a></h2>
<section id="building-tpc-e-tools">
<h3><a class="toc-backref" href="#toc-entry-9" role="doc-backlink">Building TPC-E Tools</a></h3>
<p>Download the TPC-E Tools directly from the TPC:
<a class="reference external" href="https://www.tpc.org/tpc_documents_current_versions/current_specifications5.asp">https://www.tpc.org/tpc_documents_current_versions/current_specifications5.asp</a></p>
<p>The kit requires the TPC-E Tools to be built for the specific database
management system to be tested.  The TPC-E Tools is developed in such a way
that it needs to rebuilt or another copy needs to be built if a different
database management system is to be tested.</p>
<p>DBT-5 provides a script to apply patches and code to compile the TPC-E Tools.
The patches that are applied are minor code changes and code is supplied to
build sponsor supplied code.</p>
<p>For example, to build the TPC-E Tools for PostgreSQL (pgsql), unzip the TPC-E
Tools zip file into an empty directory and run <cite>dbt5-build-egen</cite> against the
resulting directory:</p>
<pre class="literal-block">mkdir /tmp/egen
cd /tmp/egen
unzip /path/to/*-tpc-e-tool.zip
dbt5-build-egen /tmp/egen</pre>
</section>
</section>
<section id="database-management-system-notes">
<h2><a class="toc-backref" href="#toc-entry-10" role="doc-backlink">Database Management System Notes</a></h2>
<section id="postgresql">
<h3><a class="toc-backref" href="#toc-entry-11" role="doc-backlink">PostgreSQL</a></h3>
<section id="building-the-kit">
<h4><a class="toc-backref" href="#toc-entry-12" role="doc-backlink">Building the Kit</a></h4>
<p>Developed against PostgreSQL 8.4 and newer.  May work with older versions but
not quite tested.</p>
<p>By default, the kit will use PL/pgsql stored functions, but you may use C
stored functions instead or have the transaction logic be executed on the
client-size.  The C stored functions need to be separately built and installed
on the database system before they can be used by the database:</p>
<pre class="literal-block">cd storedproc/pgsql/c
make
make install
dbt5 pgsql-load-stored-procs -t c</pre>
</section>
<section id="configuration">
<h4><a class="toc-backref" href="#toc-entry-13" role="doc-backlink">Configuration</a></h4>
<p>The transaction code expects PostgreSQL to use its default datestyle of 'iso,
dmy'.</p>
</section>
<section id="build-the-database">
<h4><a class="toc-backref" href="#toc-entry-14" role="doc-backlink">Build the Database</a></h4>
<p>To build the minimum sized database in a database <cite>dbt5</cite>:</p>
<pre class="literal-block">dbt5 build --tpcetools=/tmp/egen pgsql</pre>
</section>
<section id="run-a-test">
<h4><a class="toc-backref" href="#toc-entry-15" role="doc-backlink">Run a Test</a></h4>
<p>Run a quick 120 second (2 minute) test with 1 user:</p>
<pre class="literal-block">dbt5 run -d 120 pgsql /tmp/results</pre>
</section>
</section>
</section>
<section id="performance-testing">
<h2><a class="toc-backref" href="#toc-entry-16" role="doc-backlink">Performance Testing</a></h2>
<p>There are many additional performance testing scenarios beyond using this
workload as defined by the TPC specification.  This sections describes some of
them.</p>
<section id="database-connection-scaling">
<h3><a class="toc-backref" href="#toc-entry-17" role="doc-backlink">Database Connection Scaling</a></h3>
<p>This test is performed by the <em>test-user-scaling</em> script.</p>
<p>The purpose of this test is determine how many users, or database connections,
are needed to get as much throughput as possible out of the system.</p>
<p>This script is run a series of tests starting with 1 user up to the number of
detected processors of the driver system, adding 1 user per step in the series.
The script is primarily intended to be run in a 1-tier system configuration,
but may be run in a 2-tier configuration and may needs some additional
intelligence or options for that.</p>
<p>Each step in the series will spend 1 minute to warm up and establish all
connections to the database, then run for an additional 5 minutes and stop
before starting the next test in the series.  The warm up time and test
duration can be varied.</p>
<p>At the end of the test, the script will create a bar plot of the reported
metric of each test vs. the number of users.  The sar data from all the tests
will be aggregated and plotted.</p>
<p>Here are some examples plots from a system with 4 logical processors where it
spend 1 minute warming up before running another 5 minutes.</p>
<figure class="align-center">
<a class="reference external image-reference" href="test-user-scaling/trpu.png">
<img alt="test-user-scaling/trpu.png" src="test-user-scaling/trpu.png" style="width: 100%;" />
</a>
<figcaption>
<p>Connection Scaling Transaction Rates per user</p>
</figcaption>
</figure>
<figure class="align-center">
<a class="reference external image-reference" href="test-user-scaling/t9-transaction-rate.png">
<img alt="test-user-scaling/t9-transaction-rate.png" src="test-user-scaling/t9-transaction-rate.png" style="width: 100%;" />
</a>
<figcaption>
<p>Connection Scaling Transaction Rates</p>
</figcaption>
</figure>
<figure class="align-center">
<a class="reference external image-reference" href="test-user-scaling/sar-cpu-agg-busy.png">
<img alt="test-user-scaling/sar-cpu-agg-busy.png" src="test-user-scaling/sar-cpu-agg-busy.png" style="width: 100%;" />
</a>
<figcaption>
<p>Connection Scaling Processor Utilization</p>
</figcaption>
</figure>
</section>
<section id="database-parameter-effects">
<h3><a class="toc-backref" href="#toc-entry-18" role="doc-backlink">Database Parameter Effects</a></h3>
<p>This test is performed by the <em>test-db-param</em> script.</p>
<p>The purpose of this test is to evaluate the effects of a changing a single
database parameter.</p>
<p>This script must be used with a configuration file and cannot currently be
controlled with just command line arguments.</p>
<p>The configure file must contain the following details in addition to any other
required configuration parameter (see configuration instructions in <strong>User
Guide</strong> section of the documentation):</p>
<ol class="arabic simple">
<li><p>database start command</p></li>
<li><p>database stop command</p></li>
<li><p>database parameter name</p></li>
<li><p>database parameter values to test</p></li>
</ol>
<p>Here is an example for PostgreSQL that is testing 3 difference values for
<cite>shared_buffers</cite>:</p>
<pre class="literal-block">db_start_command = &quot;pg_ctl -D /tmp/pgdata start&quot;
db_stop_command = &quot;pg_ctl -D /tmp/pgdata stop -m fast&quot;
db_param_name = &quot;shared_buffers&quot;
db_param_values = [&quot;1GB&quot;, &quot;2GB&quot;, &quot;3GB&quot;]</pre>
<p>At the end of the test, the script will create a bar plot of the reported
metric of each test vs. the value of database parameter being evaluated.  The
sar data from all the tests will be aggregated and plotted, as shown in the
<strong>Database Parameter Effects</strong> section.</p>
<p>Here is an example plot of the above example.</p>
<figure class="align-center">
<a class="reference external image-reference" href="test-db-param/trpp.png">
<img alt="test-db-param/trpp.png" src="test-db-param/trpp.png" style="width: 100%;" />
</a>
<figcaption>
<p>Evaluating PostgreSQL shared_buffers</p>
</figcaption>
</figure>
</section>
</section>
<section id="developer-guide">
<h2><a class="toc-backref" href="#toc-entry-19" role="doc-backlink">Developer Guide</a></h2>
<p>This document is for detailing anything related to the development of this test
kit.</p>
<section id="building-the-kit-1">
<h3><a class="toc-backref" href="#toc-entry-20" role="doc-backlink">Building the Kit</a></h3>
<p>CMake is build system used for this kit.  A <cite>Makefile.cmake</cite> is provided to
automate some of the tasks.</p>
<p>Building for debugging:</p>
<pre class="literal-block">make -f Makefile.cmake debug</pre>
<p>Building for release:</p>
<pre class="literal-block">make -f Makefile.cmake release</pre>
<p>Building source packages:</p>
<pre class="literal-block">make -f Makefile.cmake package</pre>
<p>See the <strong>AppImage</strong> section for details on building an AppImage.  There are
additional requirements for the <cite>appimage</cite> target in the <cite>Makefile.cmake</cite>.
Alternatively, the kit provides scripts in the <em>tools</em> diretory to create a
container that can create an AppImage.</p>
</section>
<section id="appimage">
<h3><a class="toc-backref" href="#toc-entry-21" role="doc-backlink">AppImage</a></h3>
<p>AppImages are only for Linux based systems: <a class="reference external" href="https://appimage.org/">https://appimage.org/</a></p>
<p>The AppImageKit AppImage can be downloaded from:
<a class="reference external" href="https://github.com/AppImage/AppImageKit/releases">https://github.com/AppImage/AppImageKit/releases</a></p>
<p>It is recommended to build AppImages on older distributions:
<a class="reference external" href="https://docs.appimage.org/introduction/concepts.html#build-on-old-systems-run-on-newer-systems">https://docs.appimage.org/introduction/concepts.html#build-on-old-systems-run-on-newer-systems</a></p>
<p>The logo used is the number &quot;5&quot; from the Freeware Metal On Metal Font.</p>
<p>See the <cite>README.rst</cite> in the <cite>tools/</cite> directory for an example of creating
an AppImage with a Podman container.</p>
<section id="building-the-appimage">
<h4><a class="toc-backref" href="#toc-entry-22" role="doc-backlink">Building the AppImage</a></h4>
<p>The AppImages builds a custom minimally configured PostgreSQL build to reduce
library dependency requirements.  Part of this reason is to make it easier to
include libraries with compatible licences.  At least version PostgreSQL 11
should be used for the <cite>pg_type_d.h</cite> header file.</p>
<p>At the time of this document, PostgreSQL 11 was configured with the following
options:</p>
<pre class="literal-block">./configure --without-ldap --without-readline --without-zlib \
      --without-gssapi --with-openssl</pre>
<p>Don't forget that both <cite>PATH</cite> and <cite>LD_LIBRARY_PATH</cite> may need to be set
appropriately depending on where the custom build of PostgreSQL is installed.</p>
</section>
<section id="including-tpc-e-tools-in-the-appimage">
<h4><a class="toc-backref" href="#toc-entry-23" role="doc-backlink">Including TPC-E Tools in the AppImage</a></h4>
<p>Review the TPC EULA for redistribution of TPC provided code and binaries before
redistributing any AppImages that include any TPC provided code or binaries:
<a class="reference external" href="https://www.tpc.org/tpc_documents_current_versions/current_specifications5.asp">https://www.tpc.org/tpc_documents_current_versions/current_specifications5.asp</a></p>
<p>In the source directory, create the subdirectory <em>egen</em> and unzip the TPC-E
tools into it:</p>
<pre class="literal-block">mkdir egen
cd egen
unzip /tmp/*-tpc-e-tool.zip</pre>
<p>Two scripts are provided, one to create a container for building the AppImage
and one to building the AppImage:</p>
<pre class="literal-block">EGEN=tpc-e-tool.zip tools/build-appimage-container
EGEN=tpc-e-tool.zip tools/build-appimage</pre>
<p>The environment variable <cite>EGEN</cite> must be set to location and name of the TPC-E
Tools zip file otherwise the AppImage will be created without the TPC-E tools
included.</p>
<p>When the TPC-E Tools are included in the AppImage, the <em>build</em> and <em>run</em>
commands do not need the use of the <cite>--tpcetools</cite> flag and will automatically
use the included TPC-E Tools binaries.</p>
</section>
</section>
</section>
</main>
</body>
</html>
